---
import type { CollectionEntry } from "astro:content";
import { GlowCard } from "@/components/ui/spotlight-card";

type Props = {
  entry: CollectionEntry<"blog">;
};

const { entry } = Astro.props as {
  entry: CollectionEntry<"blog">;
};

const tag = entry.data.tag || "resistance";
const isTakeover = tag === "takeover";

// Choose glow color based on tag
const glowColor = isTakeover ? "red" : "blue";
---

<li>
  <GlowCard client:load glowColor={glowColor} customSize={true} width="100%" height="auto">
    <a
      href={`/${entry.collection}/${entry.id}`}
      class="block group"
      data-tag={tag}
    >
      <div class="flex flex-col h-full gap-4">
        {/* Image */}
        <div class="w-full aspect-[610/400] overflow-hidden rounded-xl">
          <img
            src={entry.data.image?.url ||
              `https://placehold.co/600x400?text=${entry.data.title}`}
            alt={entry.data.image?.alt || entry.data.title}
            class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
        </div>

        {/* Content */}
        <div class="flex flex-col gap-3">
          {/* Tag */}
          <div class="flex items-center gap-2">
            <span class:list={[
              "text-xs font-bold uppercase px-3 py-1 rounded-full",
              isTakeover ? "bg-primary/20 text-primary" : "bg-blue-500/20 text-blue-400"
            ]}>
              {tag}
            </span>
            <time class="text-sm text-secondary/70">
              {entry.data.date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
              })}
            </time>
          </div>

          {/* Title */}
          <h3 class:list={[
            "heading text-xl md:text-2xl font-bold line-clamp-2 transition-colors group-hover:opacity-80",
            isTakeover ? "takeover-gradient-text" : "resistance-gradient-text"
          ]}>
            {entry.data.title}
          </h3>

          {/* Description */}
          <p class="text-base text-secondary line-clamp-3">
            {entry.data.description}
          </p>

          {/* Read More CTA */}
          <div class="mt-auto pt-2">
            <span class:list={[
              "inline-flex items-center gap-2 text-sm font-bold transition-transform group-hover:translate-x-1",
              isTakeover ? "text-primary" : "text-blue-400"
            ]}>
              Read Article
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </span>
          </div>
        </div>
      </div>
    </a>
  </GlowCard>
</li>

<style>
  .takeover-gradient-text {
    background: linear-gradient(90deg, #FF4C4C, #FF6B3D, #E63946);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-shift 8s ease-in-out infinite;
  }

  .resistance-gradient-text {
    background: linear-gradient(90deg, #5AA469, #6FC7B8, #2E8BC0);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-shift 8s ease-in-out infinite;
  }

  @keyframes gradient-shift {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  /* Remove link underline */
  a {
    text-decoration: none;
  }
</style>

