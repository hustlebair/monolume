---
import { SITE } from "@consts";

const links = [
  { name: "Home", href: "/", target: "_self" },
  { name: "AI Tools", href: "/ai-tools", target: "_self" },
  { name: "Systems ðŸ’¸", href: "/systems", target: "_self" },
  { name: "The Market", href: "/market", target: "_self" },
  { name: "The Resistance", href: "/blog", target: "_self", glowing: true },
  { name: "About", href: "/about", target: "_self" },
];
---

<header class="w-full header-with-shadow">
  <div class="container mx-auto flex items-center justify-between p-4 bg-background/90 backdrop-blur-sm rounded-b-2xl mx-4 header-glow">
    <a href="/" class="font-bold font-plex text-4xl">
      P.T.O
    </a>
    <div class="flex items-center space-x-4">
      <nav class="space-x-3 text-secondary hidden md:block">
        {
          links.map((link) => (
            <a
              href={link.href}
              class={`hover:border-b-2 hover:border-dashed hover:border-secondary pb-0.5 ${link.glowing ? 'resistance-glow' : ''}`}
            >
              {link.name}
            </a>
          ))
        }
      </nav>
      <button
        id="theme-toggle"
        class="p-2 rounded-lg hover:bg-secondary/20 transition-colors"
        aria-label="Toggle theme"
      >
        <svg id="sun-icon" class="w-5 h-5 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
        </svg>
        <svg id="moon-icon" class="w-5 h-5 text-secondary hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
        </svg>
      </button>
      <button
        id="menu-toggle"
        class="hamburger focus:outline-none flex md:hidden"
        aria-label="Toggle navigation"
      >
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </div>
  </div>
          <div
            id="menu-mobile"
            class="hidden md:hidden space-x-3 text-secondary bg-background backdrop-blur-2xl w-full p-4 mobile-menu-glow"
          >
    <nav class="flex flex-col gap-4 text-2xl">
      {
        links.map((link) => (
          <a
            href={link.href}
            class={`hover:border-b-2 hover:border-dashed hover:border-secondary pb-0.5 ${link.glowing ? 'resistance-glow' : ''}`}
          >
            {link.name}
          </a>
        ))
      }
    </nav>
  </div>
</header>

<style>
  .resistance-glow {
    color: #FF4C4C;
    text-shadow: 0 0 10px #FF4C4C, 0 0 20px rgba(255, 76, 76, 0.5);
    animation: pulse-glow 2s ease-in-out infinite alternate;
  }

  @keyframes pulse-glow {
    from {
      text-shadow: 0 0 10px #FF4C4C, 0 0 20px rgba(255, 76, 76, 0.5);
    }
    to {
      text-shadow: 0 0 15px #FF4C4C, 0 0 30px rgba(255, 76, 76, 0.8);
    }
  }

  .hamburger {
    gap: 5px;
    cursor: pointer;
    position: relative;
    width: 24px;
    height: 21px;
    padding: 0;
    border: 0;
    background: transparent;
  }

  .hamburger-line {
    width: 24px;
    height: 3px;
    background-color: var(--color-secondary, #000000);
    transition: all 0.3s ease;
    position: absolute;
    left: 0;
  }

  .hamburger-line:nth-child(1) {
    top: 0;
  }

  .hamburger-line:nth-child(2) {
    top: 9px;
  }

  .hamburger-line:nth-child(3) {
    top: 18px;
  }

  .hamburger.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg);
    top: 9px;
  }

  .hamburger.active .hamburger-line:nth-child(2) {
    display: none;
    opacity: 0;
  }

  .hamburger.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg);
    top: 9px;
  }

  header {
    width: 100%;
    position: relative;
  }

  .header-with-shadow {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  [data-theme="dark"] .header-with-shadow {
    box-shadow: 0 4px 12px rgba(255, 255, 255, 0.15);
  }

  /* Mobile edge-to-edge */
  @media (max-width: 768px) {
    header .container {
      margin-left: 0.5rem;
      margin-right: 0.5rem;
    }

    #menu-mobile {
      width: 100%;
      left: 0;
      right: 0;
    }
  }

  @media (max-width: 480px) {
    header .container {
      margin-left: 0.25rem;
      margin-right: 0.25rem;
      padding: 0.75rem;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const menuMobile = document.getElementById("menu-mobile");
    const toggle = document.getElementById("menu-toggle");
    const themeToggle = document.getElementById("theme-toggle");
    const sunIcon = document.getElementById("sun-icon");
    const moonIcon = document.getElementById("moon-icon");
    
    // Mobile menu toggle
    toggle?.addEventListener("click", () => {
      menuMobile?.classList.toggle("hidden");
      toggle.classList.toggle("active");
      const expanded = toggle.classList.contains("active");
      toggle.setAttribute("aria-expanded", String(expanded));
    });

            // Theme toggle
            const currentTheme = localStorage.getItem("theme") || "dark";
            document.documentElement.setAttribute("data-theme", currentTheme);
            
            if (currentTheme === "light") {
              sunIcon?.classList.add("hidden");
              moonIcon?.classList.remove("hidden");
            }

    themeToggle?.addEventListener("click", () => {
      const currentTheme = document.documentElement.getAttribute("data-theme");
      const newTheme = currentTheme === "dark" ? "light" : "dark";
      
      document.documentElement.setAttribute("data-theme", newTheme);
      localStorage.setItem("theme", newTheme);
      
      if (newTheme === "light") {
        sunIcon?.classList.add("hidden");
        moonIcon?.classList.remove("hidden");
      } else {
        sunIcon?.classList.remove("hidden");
        moonIcon?.classList.add("hidden");
      }
    });
  });
</script>
