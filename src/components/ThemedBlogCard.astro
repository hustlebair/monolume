---
import type { CollectionEntry } from "astro:content";
import { BackgroundGradient } from "@/components/ui/background-gradient";

type Props = {
  entry: CollectionEntry<"blog">;
};

const { entry } = Astro.props as {
  entry: CollectionEntry<"blog">;
};

const tag = entry.data.tag || "resistance";
const isTakeover = tag === "takeover";
---

<a
  class={`group block cursor-pointer blog-card-link ${isTakeover ? 'takeover-theme' : 'resistance-theme'}`}
  href={`/${entry.collection}/${entry.id}`}
  data-tag={tag}
>
  <div class="blog-card-wrapper relative rounded-2xl">
    <BackgroundGradient 
      client:visible
      className="rounded-2xl"
      containerClassName="rounded-2xl"
      animate={true}
      theme={isTakeover ? "takeover" : "resistance"}
    >
      <div class="blog-card-container relative rounded-2xl overflow-hidden">
      <div class="w-full aspect-[610/400] overflow-hidden">
        <img
          src={entry.data.image?.url ||
            `https://placehold.co/600x400?text=${entry.data.title}`}
          alt={entry.data.image?.alt || entry.data.title}
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      </div>

      <div class="space-y-4 text-center p-6">
        <h3
          class={`heading uppercase text-xl md:text-2xl line-clamp-2 ${isTakeover ? 'takeover-gradient-text' : 'resistance-gradient-text'}`}
        >
          {entry.data.title}
        </h3>
        <p
          class="text-base md:text-lg text-foreground line-clamp-3"
        >
          {entry.data.description}
        </p>
      </div>
    </div>
    </BackgroundGradient>
  </div>
</a>

<style>
  .blog-card-link {
    text-decoration: none;
  }

  .blog-card-wrapper {
    transition: all 0.3s ease;
    --card-border-radius: 1rem;
    border-radius: var(--card-border-radius);
  }
  
  .blog-card-wrapper :global(.glow::after) {
    border-radius: var(--card-border-radius) !important;
  }

  .takeover-theme:hover .blog-card-wrapper {
    transform: translateY(-4px);
  }

  .resistance-theme:hover .blog-card-wrapper {
    transform: translateY(-4px);
  }

  .blog-card-container {
    background: var(--background);
  }

  .takeover-theme:hover .takeover-gradient-text {
    animation: glitch-effect 0.6s ease-in-out;
  }

  .takeover-gradient-text {
    background: linear-gradient(90deg, #FF4C4C, #FF6B3D, #E63946);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-shift 8s ease-in-out infinite;
  }

  .resistance-gradient-text {
    background: linear-gradient(90deg, #5AA469, #6FC7B8, #2E8BC0);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-shift 8s ease-in-out infinite;
  }

  @keyframes glitch-effect {
    0%, 100% {
      transform: translateX(0);
    }
    20% {
      transform: translateX(-2px);
    }
    40% {
      transform: translateX(2px);
    }
    60% {
      transform: translateX(-1px);
    }
    80% {
      transform: translateX(1px);
    }
  }

  @keyframes gradient-shift {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }
</style>
